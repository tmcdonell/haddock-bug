<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification, DeriveDataTypeable #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module      :  Language.C.Data.Error</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright   :  (c) 2008 Benedikt Huber, Manuel M. T. Chakravarty</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Maintainer  :  benedikt.huber@gmail.com</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Portability :  ghc</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Base type for errors occurring in parsing, analysing and pretty-printing.</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- With ideas from Simon Marlow's</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- &quot;An extensible dynamically-typed hierarchy of execeptions [2006]&quot;</span><span>
</span><a name="line-14"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-15"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.C.Data.Error</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-16"></a><span>    </span><span class="hs-comment">-- * Severity Level</span><span>
</span><a name="line-17"></a><span>    </span><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier hs-type">ErrorLevel</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#isHardError"><span class="hs-identifier hs-var">isHardError</span></a><span class="hs-special">,</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-comment">-- * Error class</span><span>
</span><a name="line-19"></a><span>    </span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#errorPos"><span class="hs-identifier hs-var">errorPos</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#errorLevel"><span class="hs-identifier hs-var">errorLevel</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#errorMsgs"><span class="hs-identifier hs-var">errorMsgs</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>    </span><span class="hs-comment">-- * Error 'supertype'</span><span>
</span><a name="line-21"></a><span>    </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-type">CError</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>    </span><span class="hs-comment">-- * Infos attached to errors</span><span>
</span><a name="line-23"></a><span>    </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><a href="Language.C.Data.Error.html#showError"><span class="hs-identifier hs-var">showError</span></a><span class="hs-special">,</span><a href="Language.C.Data.Error.html#showErrorInfo"><span class="hs-identifier hs-var">showErrorInfo</span></a><span class="hs-special">,</span><a href="Language.C.Data.Error.html#mkErrorInfo"><span class="hs-identifier hs-var">mkErrorInfo</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>    </span><span class="hs-comment">-- * Default error types</span><span>
</span><a name="line-25"></a><span>    </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-type">UnsupportedFeature</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#unsupportedFeature"><span class="hs-identifier hs-var">unsupportedFeature</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#unsupportedFeature_"><span class="hs-identifier hs-var">unsupportedFeature_</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>    </span><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier hs-type">UserError</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Error.html#userErr"><span class="hs-identifier hs-var">userErr</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>    </span><span class="hs-comment">-- * Raising internal errors</span><span>
</span><a name="line-28"></a><span>    </span><a href="Language.C.Data.Error.html#internalErr"><span class="hs-identifier hs-var">internalErr</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span class="hs-keyword">where</span><span>
</span><a name="line-31"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Typeable</span><span>
</span><a name="line-32"></a><span class="hs-keyword">import</span><span> </span><a href="Language.C.Data.Node.html"><span class="hs-identifier">Language.C.Data.Node</span></a><span>
</span><a name="line-33"></a><span class="hs-keyword">import</span><span> </span><a href="Language.C.Data.Position.html"><span class="hs-identifier">Language.C.Data.Position</span></a><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-comment">-- | Error levels (severity)</span><span>
</span><a name="line-36"></a><span class="hs-keyword">data</span><span> </span><a name="ErrorLevel"><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier">ErrorLevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="LevelWarn"><a href="Language.C.Data.Error.html#LevelWarn"><span class="hs-identifier">LevelWarn</span></a></a><span>
</span><a name="line-37"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="LevelError"><a href="Language.C.Data.Error.html#LevelError"><span class="hs-identifier">LevelError</span></a></a><span>
</span><a name="line-38"></a><span>                </span><span class="hs-glyph">|</span><span> </span><a name="LevelFatal"><a href="Language.C.Data.Error.html#LevelFatal"><span class="hs-identifier">LevelFatal</span></a></a><span>
</span><a name="line-39"></a><span>              </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier hs-type">ErrorLevel</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-42"></a><span>    </span><a name="local-8214565720323789997"><span class="hs-identifier">show</span></a><span> </span><a href="Language.C.Data.Error.html#LevelWarn"><span class="hs-identifier hs-var">LevelWarn</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;WARNING&quot;</span><span>
</span><a name="line-43"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Language.C.Data.Error.html#LevelError"><span class="hs-identifier hs-var">LevelError</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;ERROR&quot;</span><span>
</span><a name="line-44"></a><span>    </span><span class="hs-identifier">show</span><span> </span><a href="Language.C.Data.Error.html#LevelFatal"><span class="hs-identifier hs-var">LevelFatal</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;FATAL ERROR&quot;</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">-- | return @True@ when the given error makes it impossible to continue</span><span>
</span><a name="line-47"></a><span class="hs-comment">--   analysis or compilation.</span><span>
</span><a name="line-48"></a><span class="hs-identifier">isHardError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679046305"><span class="hs-identifier hs-type">ex</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679046305"><span class="hs-identifier hs-type">ex</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-49"></a><a name="isHardError"><a href="Language.C.Data.Error.html#isHardError"><span class="hs-identifier">isHardError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><a href="Language.C.Data.Error.html#LevelWarn"><span class="hs-identifier hs-var">LevelWarn</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Error.html#errorLevel"><span class="hs-identifier hs-var">errorLevel</span></a><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span class="hs-comment">-- | information attached to every error in Language.C</span><span>
</span><a name="line-52"></a><span class="hs-keyword">data</span><span> </span><a name="ErrorInfo"><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier">ErrorInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ErrorInfo"><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier">ErrorInfo</span></a></a><span> </span><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier hs-type">ErrorLevel</span></a><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- to facilitate newtype deriving</span><span>
</span><a name="line-55"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323789997"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#showErrorInfo"><span class="hs-identifier hs-var">showErrorInfo</span></a><span> </span><span class="hs-string">&quot;error&quot;</span><span>
</span><a name="line-56"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-57"></a><span>    </span><a name="local-8214565720323821170"><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier">errorInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-58"></a><span>    </span><a name="local-8214565720323821173"><a href="Language.C.Data.Error.html#changeErrorLevel"><span class="hs-identifier">changeErrorLevel</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679046296"><a href="#local-6989586621679046296"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679046297"><a href="#local-6989586621679046297"><span class="hs-identifier">msgs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679046298"><a href="#local-6989586621679046298"><span class="hs-identifier">lvl'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><a href="#local-6989586621679046298"><span class="hs-identifier hs-var">lvl'</span></a><span> </span><a href="#local-6989586621679046296"><span class="hs-identifier hs-var">pos</span></a><span> </span><a href="#local-6989586621679046297"><span class="hs-identifier hs-var">msgs</span></a><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-identifier">mkErrorInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier hs-type">ErrorLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span>
</span><a name="line-61"></a><a name="mkErrorInfo"><a href="Language.C.Data.Error.html#mkErrorInfo"><span class="hs-identifier">mkErrorInfo</span></a></a><span> </span><a name="local-6989586621679046306"><a href="#local-6989586621679046306"><span class="hs-identifier">lvl</span></a></a><span> </span><a name="local-6989586621679046307"><a href="#local-6989586621679046307"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621679046308"><a href="#local-6989586621679046308"><span class="hs-identifier">node</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><a href="#local-6989586621679046306"><span class="hs-identifier hs-var">lvl</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#posOfNode"><span class="hs-identifier hs-var">posOfNode</span></a><span> </span><a href="#local-6989586621679046308"><span class="hs-identifier hs-var">node</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621679046307"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | `supertype' of all errors</span><span>
</span><a name="line-64"></a><span class="hs-keyword">data</span><span> </span><a name="CError"><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier">CError</span></a></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679046289"><a href="#local-6989586621679046289"><span class="hs-identifier">err</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679046289"><span class="hs-identifier hs-type">err</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="CError"><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier">CError</span></a></a><span> </span><a href="#local-6989586621679046289"><span class="hs-identifier hs-type">err</span></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-comment">-- | errors in Language.C are instance of 'Error'</span><span>
</span><a name="line-69"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Error"><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier">Error</span></a></a><span> </span><a name="local-6989586621679046285"><a href="#local-6989586621679046285"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-comment">-- | obtain source location etc. of an error</span><span>
</span><a name="line-71"></a><span>    </span><a name="errorInfo"><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier">errorInfo</span></a></a><span>        </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-comment">-- | wrap error in 'CError'</span><span>
</span><a name="line-73"></a><span>    </span><a name="toError"><a href="Language.C.Data.Error.html#toError"><span class="hs-identifier">toError</span></a></a><span>          </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-type">CError</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-comment">-- | try to cast a generic 'CError' to the specific error type</span><span>
</span><a name="line-75"></a><span>    </span><a name="fromError"><a href="Language.C.Data.Error.html#fromError"><span class="hs-identifier">fromError</span></a></a><span>     </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-type">CError</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-comment">-- | modify the error level</span><span>
</span><a name="line-77"></a><span>    </span><a name="changeErrorLevel"><a href="Language.C.Data.Error.html#changeErrorLevel"><span class="hs-identifier">changeErrorLevel</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier hs-type">ErrorLevel</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046285"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-comment">-- default implementation</span><span>
</span><a name="line-80"></a><span>    </span><a name="local-8214565720323821172"><a href="Language.C.Data.Error.html#fromError"><span class="hs-identifier">fromError</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-var">CError</span></a><span> </span><a name="local-6989586621679046286"><a href="#local-6989586621679046286"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">cast</span><span> </span><a href="#local-6989586621679046286"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-81"></a><span>    </span><a name="local-8214565720323821171"><a href="Language.C.Data.Error.html#toError"><span class="hs-identifier">toError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-var">CError</span></a><span>
</span><a name="line-82"></a><span>    </span><a name="local-8214565720323821173"><a href="Language.C.Data.Error.html#changeErrorLevel"><span class="hs-identifier">changeErrorLevel</span></a></a><span> </span><a name="local-6989586621679046287"><a href="#local-6989586621679046287"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679046288"><a href="#local-6989586621679046288"><span class="hs-identifier">lvl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-83"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="Language.C.Data.Error.html#errorLevel"><span class="hs-identifier hs-var">errorLevel</span></a><span> </span><a href="#local-6989586621679046287"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679046288"><span class="hs-identifier hs-var">lvl</span></a><span>
</span><a name="line-84"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679046287"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-85"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;changeErrorLevel: not possible for &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679046287"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-type">CError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-88"></a><span>    </span><a name="local-8214565720323789997"><span class="hs-identifier">show</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-var">CError</span></a><span> </span><a name="local-6989586621679046295"><a href="#local-6989586621679046295"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679046295"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-89"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-type">CError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>    </span><a name="local-8214565720323821170"><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier">errorInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-var">CError</span></a><span> </span><a name="local-6989586621679046293"><a href="#local-6989586621679046293"><span class="hs-identifier">err</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier hs-var">errorInfo</span></a><span> </span><a href="#local-6989586621679046293"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-91"></a><span>    </span><a name="local-8214565720323821171"><a href="Language.C.Data.Error.html#toError"><span class="hs-identifier">toError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-92"></a><span>    </span><a name="local-8214565720323821172"><a href="Language.C.Data.Error.html#fromError"><span class="hs-identifier">fromError</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span>
</span><a name="line-93"></a><span>    </span><a name="local-8214565720323821173"><a href="Language.C.Data.Error.html#changeErrorLevel"><span class="hs-identifier">changeErrorLevel</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-var">CError</span></a><span> </span><a name="local-6989586621679046294"><a href="#local-6989586621679046294"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#CError"><span class="hs-identifier hs-var">CError</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Error.html#changeErrorLevel"><span class="hs-identifier hs-var">changeErrorLevel</span></a><span> </span><a href="#local-6989586621679046294"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | position of an @Error@</span><span>
</span><a name="line-96"></a><span class="hs-identifier">errorPos</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679046304"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679046304"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span>
</span><a name="line-97"></a><a name="errorPos"><a href="Language.C.Data.Error.html#errorPos"><span class="hs-identifier">errorPos</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679046309"><a href="#local-6989586621679046309"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046309"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier hs-var">errorInfo</span></a><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-comment">-- | severity level of an @Error@</span><span>
</span><a name="line-100"></a><span class="hs-identifier">errorLevel</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679046303"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679046303"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#ErrorLevel"><span class="hs-identifier hs-type">ErrorLevel</span></a><span>
</span><a name="line-101"></a><a name="errorLevel"><a href="Language.C.Data.Error.html#errorLevel"><span class="hs-identifier">errorLevel</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><a name="local-6989586621679046310"><a href="#local-6989586621679046310"><span class="hs-identifier">lvl</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046310"><span class="hs-identifier hs-var">lvl</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier hs-var">errorInfo</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | message lines of an @Error@</span><span>
</span><a name="line-104"></a><span class="hs-identifier">errorMsgs</span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679046302"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679046302"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-105"></a><a name="errorMsgs"><a href="Language.C.Data.Error.html#errorMsgs"><span class="hs-identifier">errorMsgs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679046311"><a href="#local-6989586621679046311"><span class="hs-identifier">msgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046311"><span class="hs-identifier hs-var">msgs</span></a><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier hs-var">errorInfo</span></a><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | error raised if a operation requires an unsupported or not yet implemented feature.</span><span>
</span><a name="line-108"></a><span class="hs-keyword">data</span><span> </span><a name="UnsupportedFeature"><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier">UnsupportedFeature</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="UnsupportedFeature"><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier">UnsupportedFeature</span></a></a><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span>
</span><a name="line-109"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-type">UnsupportedFeature</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-110"></a><span>    </span><a name="local-8214565720323821170"><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier">errorInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-var">UnsupportedFeature</span></a><span> </span><a name="local-6989586621679046291"><a href="#local-6989586621679046291"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621679046292"><a href="#local-6989586621679046292"><span class="hs-identifier">pos</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><a href="Language.C.Data.Error.html#LevelError"><span class="hs-identifier hs-var">LevelError</span></a><span> </span><a href="#local-6989586621679046292"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621679046291"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-type">UnsupportedFeature</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323789997"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#showError"><span class="hs-identifier hs-var">showError</span></a><span> </span><span class="hs-string">&quot;Unsupported Feature&quot;</span><span>
</span><a name="line-112"></a><span>
</span><a name="line-113"></a><span class="hs-identifier">unsupportedFeature</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Position.html#Pos"><span class="hs-identifier hs-type">Pos</span></a><span> </span><a href="#local-6989586621679046301"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046301"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-type">UnsupportedFeature</span></a><span>
</span><a name="line-114"></a><a name="unsupportedFeature"><a href="Language.C.Data.Error.html#unsupportedFeature"><span class="hs-identifier">unsupportedFeature</span></a></a><span> </span><a name="local-6989586621679046312"><a href="#local-6989586621679046312"><span class="hs-identifier">msg</span></a></a><span> </span><a name="local-6989586621679046313"><a href="#local-6989586621679046313"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-var">UnsupportedFeature</span></a><span> </span><a href="#local-6989586621679046312"><span class="hs-identifier hs-var">msg</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Position.html#posOf"><span class="hs-identifier hs-var">posOf</span></a><span> </span><a href="#local-6989586621679046313"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-identifier">unsupportedFeature_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-type">UnsupportedFeature</span></a><span>
</span><a name="line-117"></a><a name="unsupportedFeature_"><a href="Language.C.Data.Error.html#unsupportedFeature_"><span class="hs-identifier">unsupportedFeature_</span></a></a><span> </span><a name="local-6989586621679046314"><a href="#local-6989586621679046314"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#UnsupportedFeature"><span class="hs-identifier hs-var">UnsupportedFeature</span></a><span> </span><a href="#local-6989586621679046314"><span class="hs-identifier hs-var">msg</span></a><span> </span><a href="Language.C.Data.Position.html#internalPos"><span class="hs-identifier hs-var">internalPos</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span class="hs-comment">-- | unspecified error raised by the user (in case the user does not want to define</span><span>
</span><a name="line-120"></a><span class="hs-comment">--   her own error types).</span><span>
</span><a name="line-121"></a><span class="hs-keyword">newtype</span><span> </span><a name="UserError"><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier">UserError</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a name="UserError"><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier">UserError</span></a></a><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span>
</span><a name="line-122"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier hs-type">UserError</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-123"></a><span>    </span><a name="local-8214565720323821170"><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier">errorInfo</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier hs-var">UserError</span></a><span> </span><a name="local-6989586621679046290"><a href="#local-6989586621679046290"><span class="hs-identifier">info</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679046290"><span class="hs-identifier hs-var">info</span></a><span>
</span><a name="line-124"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier hs-type">UserError</span></a><span> </span><span class="hs-keyword">where</span><span> </span><a name="local-8214565720323789997"><span class="hs-identifier">show</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#showError"><span class="hs-identifier hs-var">showError</span></a><span> </span><span class="hs-string">&quot;User Error&quot;</span><span>
</span><a name="line-125"></a><span>
</span><a name="line-126"></a><span class="hs-identifier">userErr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier hs-type">UserError</span></a><span>
</span><a name="line-127"></a><a name="userErr"><a href="Language.C.Data.Error.html#userErr"><span class="hs-identifier">userErr</span></a></a><span> </span><a name="local-6989586621679046315"><a href="#local-6989586621679046315"><span class="hs-identifier">msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#UserError"><span class="hs-identifier hs-var">UserError</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><a href="Language.C.Data.Error.html#LevelError"><span class="hs-identifier hs-var">LevelError</span></a><span> </span><a href="Language.C.Data.Position.html#internalPos"><span class="hs-identifier hs-var">internalPos</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621679046315"><span class="hs-identifier hs-var">msg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">-- other errors to be defined elsewhere</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-identifier">showError</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679046300"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046300"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-132"></a><a name="showError"><a href="Language.C.Data.Error.html#showError"><span class="hs-identifier">showError</span></a></a><span> </span><a name="local-6989586621679046316"><a href="#local-6989586621679046316"><span class="hs-identifier">short_msg</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#showErrorInfo"><span class="hs-identifier hs-var">showErrorInfo</span></a><span> </span><a href="#local-6989586621679046316"><span class="hs-identifier hs-var">short_msg</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Error.html#errorInfo"><span class="hs-identifier hs-var">errorInfo</span></a><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- | converts an error into a string using a fixed format</span><span>
</span><a name="line-135"></a><span class="hs-comment">--</span><span>
</span><a name="line-136"></a><span class="hs-comment">-- * either the lines of the long error message or the short message has to be non-empty</span><span>
</span><a name="line-137"></a><span class="hs-comment">--</span><span>
</span><a name="line-138"></a><span class="hs-comment">-- * the format is</span><span>
</span><a name="line-139"></a><span class="hs-comment">--</span><span>
</span><a name="line-140"></a><span class="hs-comment">-- &gt;    &lt;fname&gt;:&lt;row&gt;: (column &lt;col&gt;) [&lt;err lvl&gt;]</span><span>
</span><a name="line-141"></a><span class="hs-comment">-- &gt;      &gt;&gt;&gt; &lt;line_1&gt;</span><span>
</span><a name="line-142"></a><span class="hs-comment">-- &gt;      &lt;line_2&gt;</span><span>
</span><a name="line-143"></a><span class="hs-comment">-- &gt;        ...</span><span>
</span><a name="line-144"></a><span class="hs-comment">-- &gt;      &lt;line_n&gt;</span><span>
</span><a name="line-145"></a><span class="hs-identifier">showErrorInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-type">ErrorInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-146"></a><a name="showErrorInfo"><a href="Language.C.Data.Error.html#showErrorInfo"><span class="hs-identifier">showErrorInfo</span></a></a><span> </span><a name="local-6989586621679046317"><a href="#local-6989586621679046317"><span class="hs-identifier">short_msg</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#ErrorInfo"><span class="hs-identifier hs-var">ErrorInfo</span></a><span> </span><a name="local-6989586621679046318"><a href="#local-6989586621679046318"><span class="hs-identifier">level</span></a></a><span> </span><a name="local-6989586621679046319"><a href="#local-6989586621679046319"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679046320"><a href="#local-6989586621679046320"><span class="hs-identifier">msgs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-147"></a><span>    </span><a href="#local-6989586621679046321"><span class="hs-identifier hs-var">header</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679046323"><span class="hs-identifier hs-var">showMsgLines</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679046317"><span class="hs-identifier hs-var">short_msg</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679046320"><span class="hs-identifier hs-var">msgs</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679046317"><span class="hs-identifier hs-var">short_msg</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679046320"><span class="hs-identifier hs-var">msgs</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-149"></a><span>    </span><a name="local-6989586621679046321"><a href="#local-6989586621679046321"><span class="hs-identifier">header</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679046322"><span class="hs-identifier hs-var">showPos</span></a><span> </span><a href="#local-6989586621679046319"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;[&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679046318"><span class="hs-identifier hs-var">level</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;]&quot;</span><span>
</span><a name="line-150"></a><span>    </span><a name="local-6989586621679046322"><a href="#local-6989586621679046322"><span class="hs-identifier">showPos</span></a></a><span> </span><a name="local-6989586621679046324"><a href="#local-6989586621679046324"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="Language.C.Data.Position.html#isSourcePos"><span class="hs-identifier hs-var">isSourcePos</span></a><span> </span><a href="#local-6989586621679046324"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Position.html#posFile"><span class="hs-identifier hs-var">posFile</span></a><span> </span><a href="#local-6989586621679046324"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;:&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">posRow</span><span> </span><a href="#local-6989586621679046319"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-151"></a><span>                                </span><span class="hs-string">&quot;(column &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">posColumn</span><span> </span><a href="#local-6989586621679046319"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;) &quot;</span><span>
</span><a name="line-152"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679046324"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;:: &quot;</span><span>
</span><a name="line-153"></a><span>    </span><a name="local-6989586621679046323"><a href="#local-6989586621679046323"><span class="hs-identifier">showMsgLines</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#internalErr"><span class="hs-identifier hs-var">internalErr</span></a><span> </span><span class="hs-string">&quot;No short message or error message provided.&quot;</span><span>
</span><a name="line-154"></a><span>    </span><span class="hs-identifier">showMsgLines</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679046325"><a href="#local-6989586621679046325"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679046326"><a href="#local-6989586621679046326"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Error.html#indent"><span class="hs-identifier hs-var">indent</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;&gt;&gt;&gt; &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679046325"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#indent"><span class="hs-identifier hs-var">indent</span></a><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679046326"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- internal errors</span><span>
</span><a name="line-158"></a><span class="hs-identifier">internalErrPrefix</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-159"></a><a name="internalErrPrefix"><a href="Language.C.Data.Error.html#internalErrPrefix"><span class="hs-identifier">internalErrPrefix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;Language.C : Internal Error&quot;</span><span> </span><span class="hs-special">,</span><span>
</span><a name="line-160"></a><span>                              </span><span class="hs-string">&quot;This is propably a bug, and should be reported at &quot;</span><span class="hs-operator hs-var">++</span><span>
</span><a name="line-161"></a><span>                              </span><span class="hs-string">&quot;http://www.sivity.net/projects/language.c/newticket&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | raise a fatal internal error; message may have multiple lines</span><span>
</span><a name="line-164"></a><span class="hs-identifier">internalErr</span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679046299"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-165"></a><a name="internalErr"><a href="Language.C.Data.Error.html#internalErr"><span class="hs-identifier">internalErr</span></a></a><span> </span><a name="local-6989586621679046327"><a href="#local-6989586621679046327"><span class="hs-identifier">msg</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#internalErrPrefix"><span class="hs-identifier hs-var">internalErrPrefix</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span>
</span><a name="line-166"></a><span>                       </span><span class="hs-operator hs-var">++</span><span> </span><a href="Language.C.Data.Error.html#indentLines"><span class="hs-identifier hs-var">indentLines</span></a><span> </span><a href="#local-6989586621679046327"><span class="hs-identifier hs-var">msg</span></a><span>
</span><a name="line-167"></a><span>                       </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;\n&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-168"></a><span class="hs-identifier">indent</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-169"></a><a name="indent"><a href="Language.C.Data.Error.html#indent"><span class="hs-identifier">indent</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;  &quot;</span><span>
</span><a name="line-170"></a><span class="hs-identifier">indentLines</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-171"></a><a name="indentLines"><a href="Language.C.Data.Error.html#indentLines"><span class="hs-identifier">indentLines</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Error.html#indent"><span class="hs-identifier hs-var">indent</span></a><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">lines</span><span>
</span><a name="line-172"></a></pre></body></html>