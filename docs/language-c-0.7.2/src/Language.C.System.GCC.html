<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module      :  Language.C.System.Gcc</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright   :  (c) 2008 Benedikt Huber</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- Maintainer  :  benedikt.huber@gmail.com</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-10"></a><span class="hs-comment">--</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- Invoking gcc for preprocessing and compiling.</span><span>
</span><a name="line-12"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-13"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.C.System.GCC</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-14"></a><span>    </span><a href="Language.C.System.GCC.html#GCC"><span class="hs-identifier hs-type">GCC</span></a><span class="hs-special">,</span><a href="Language.C.System.GCC.html#newGCC"><span class="hs-identifier hs-var">newGCC</span></a><span class="hs-special">,</span><span>
</span><a name="line-15"></a><span class="hs-special">)</span><span>
</span><a name="line-16"></a><span class="hs-keyword">where</span><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Language.C.Data.RList.html"><span class="hs-identifier">Language.C.Data.RList</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">RList</span><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span> </span><a href="Language.C.System.Preprocess.html"><span class="hs-identifier">Language.C.System.Preprocess</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Maybe</span><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Process</span><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System.Directory</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.List</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">-- | @GCC@ represents a reference to the gcc compiler</span><span>
</span><a name="line-25"></a><span class="hs-keyword">newtype</span><span> </span><a name="GCC"><a href="Language.C.System.GCC.html#GCC"><span class="hs-identifier">GCC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="GCC"><a href="Language.C.System.GCC.html#GCC"><span class="hs-identifier">GCC</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="gccPath"><a href="Language.C.System.GCC.html#gccPath"><span class="hs-identifier">gccPath</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span class="hs-comment">-- | create a reference to @gcc@</span><span>
</span><a name="line-28"></a><span class="hs-identifier">newGCC</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.System.GCC.html#GCC"><span class="hs-identifier hs-type">GCC</span></a><span>
</span><a name="line-29"></a><a name="newGCC"><a href="Language.C.System.GCC.html#newGCC"><span class="hs-identifier">newGCC</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.System.GCC.html#GCC"><span class="hs-identifier hs-var">GCC</span></a><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.System.Preprocess.html#Preprocessor"><span class="hs-identifier hs-type">Preprocessor</span></a><span> </span><a href="Language.C.System.GCC.html#GCC"><span class="hs-identifier hs-type">GCC</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>    </span><a name="local-8214565720323960054"><a href="Language.C.System.Preprocess.html#parseCPPArgs"><span class="hs-identifier">parseCPPArgs</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.System.GCC.html#gccParseCPPArgs"><span class="hs-identifier hs-var">gccParseCPPArgs</span></a><span>
</span><a name="line-33"></a><span>    </span><a name="local-8214565720323960055"><a href="Language.C.System.Preprocess.html#runCPP"><span class="hs-identifier">runCPP</span></a></a><span> </span><a name="local-6989586621679187429"><a href="#local-6989586621679187429"><span class="hs-identifier">gcc</span></a></a><span> </span><a name="local-6989586621679187430"><a href="#local-6989586621679187430"><span class="hs-identifier">cpp_args</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-34"></a><span>        </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- copy the input to the outputfile, because in case the input is preprocessed,</span><span>
</span><a name="line-35"></a><span>            </span><span class="hs-comment">-- gcc -E will do nothing.</span><span>
</span><a name="line-36"></a><span>            </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679187431"><span class="hs-identifier hs-var">copyWritable</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">inputFile</span><span> </span><a href="#local-6989586621679187430"><span class="hs-identifier hs-var">cpp_args</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">outputFile</span><span> </span><a href="#local-6989586621679187430"><span class="hs-identifier hs-var">cpp_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-37"></a><span>            </span><span class="hs-identifier hs-var">rawSystem</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">gccPath</span><span> </span><a href="#local-6989586621679187429"><span class="hs-identifier hs-var">gcc</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.GCC.html#buildCppArgs"><span class="hs-identifier hs-var">buildCppArgs</span></a><span> </span><a href="#local-6989586621679187430"><span class="hs-identifier hs-var">cpp_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>                </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679187431"><a href="#local-6989586621679187431"><span class="hs-identifier">copyWritable</span></a></a><span> </span><a name="local-6989586621679187432"><a href="#local-6989586621679187432"><span class="hs-identifier">source</span></a></a><span> </span><a name="local-6989586621679187433"><a href="#local-6989586621679187433"><span class="hs-identifier">target</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">copyFile</span><span> </span><a href="#local-6989586621679187432"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">target</span></a><span>
</span><a name="line-39"></a><span>                                                      </span><a name="local-6989586621679187434"><a href="#local-6989586621679187434"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getPermissions</span><span> </span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">target</span></a><span>
</span><a name="line-40"></a><span>                                                      </span><span class="hs-identifier hs-var">setPermissions</span><span> </span><a href="#local-6989586621679187433"><span class="hs-identifier hs-var">target</span></a><span> </span><a href="#local-6989586621679187434"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">{</span><span class="hs-identifier">writable</span><span class="hs-glyph">=</span><span class="hs-identifier hs-var">True</span><span class="hs-special">}</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span class="hs-comment">-- | Parse arguments for preprocessing via GCC.</span><span>
</span><a name="line-43"></a><span class="hs-comment">--   At least one .c, .hc or .h file has to be present.</span><span>
</span><a name="line-44"></a><span class="hs-comment">--   For now we only support the most important gcc options.</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-comment">--   1) Parse all flags relevant to CppArgs</span><span>
</span><a name="line-47"></a><span class="hs-comment">--   2) Move -c,-S,-M? to other_args</span><span>
</span><a name="line-48"></a><span class="hs-comment">--   3) Strip -E</span><span>
</span><a name="line-49"></a><span class="hs-comment">--   4) The rest goes into extra_args</span><span>
</span><a name="line-50"></a><span class="hs-identifier">gccParseCPPArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#CppArgs"><span class="hs-identifier hs-type">CppArgs</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-51"></a><a name="gccParseCPPArgs"><a href="Language.C.System.GCC.html#gccParseCPPArgs"><span class="hs-identifier">gccParseCPPArgs</span></a></a><span> </span><a name="local-6989586621679187739"><a href="#local-6989586621679187739"><span class="hs-identifier">args</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-52"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><a href="Language.C.Data.RList.html#empty"><span class="hs-identifier hs-var">RList.empty</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a href="Language.C.Data.RList.html#empty"><span class="hs-identifier hs-var">RList.empty</span></a><span class="hs-special">,</span><a href="Language.C.Data.RList.html#empty"><span class="hs-identifier hs-var">RList.empty</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187739"><span class="hs-identifier hs-var">args</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-53"></a><span>        </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679187775"><a href="#local-6989586621679187775"><span class="hs-identifier">err</span></a></a><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679187775"><span class="hs-identifier hs-var">err</span></a><span>
</span><a name="line-54"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Nothing</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;No .c / .hc / .h source file given&quot;</span><span>
</span><a name="line-55"></a><span>        </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679187776"><a href="#local-6989586621679187776"><span class="hs-identifier">input_file</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187777"><a href="#local-6989586621679187777"><span class="hs-identifier">output_file_opt</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187778"><a href="#local-6989586621679187778"><span class="hs-identifier">cpp_opts</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><a name="local-6989586621679187779"><a href="#local-6989586621679187779"><span class="hs-identifier">extra_args</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187780"><a href="#local-6989586621679187780"><span class="hs-identifier">other_args</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#rawCppArgs"><span class="hs-identifier hs-var">rawCppArgs</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.RList.html#reverse"><span class="hs-identifier hs-var">RList.reverse</span></a><span> </span><a href="#local-6989586621679187779"><span class="hs-identifier hs-var">extra_args</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187776"><span class="hs-identifier hs-var">input_file</span></a><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span>                      </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">outputFile</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679187777"><span class="hs-identifier hs-var">output_file_opt</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">cppOptions</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.RList.html#reverse"><span class="hs-identifier hs-var">RList.reverse</span></a><span> </span><a href="#local-6989586621679187778"><span class="hs-identifier hs-var">cpp_opts</span></a><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>                      </span><a href="Language.C.Data.RList.html#reverse"><span class="hs-identifier hs-var">RList.reverse</span></a><span> </span><a href="#local-6989586621679187780"><span class="hs-identifier hs-var">other_args</span></a><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-60"></a><span>    </span><span class="hs-identifier">mungeArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.System.GCC.html#ParseArgsState"><span class="hs-identifier hs-type">ParseArgsState</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Language.C.System.GCC.html#ParseArgsState"><span class="hs-identifier hs-type">ParseArgsState</span></a><span>
</span><a name="line-61"></a><span>    </span><a name="local-6989586621679187740"><a href="#local-6989586621679187740"><span class="hs-identifier">mungeArgs</span></a></a><span> </span><a name="local-6989586621679187743"><a href="#local-6989586621679187743"><span class="hs-identifier">parsed</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><span> </span><a name="local-6989586621679187744"><a href="#local-6989586621679187744"><span class="hs-identifier">cpp_args</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679187745"><a href="#local-6989586621679187745"><span class="hs-identifier">inp</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187746"><a href="#local-6989586621679187746"><span class="hs-identifier">out</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187747"><a href="#local-6989586621679187747"><span class="hs-identifier">cpp_opts</span></a></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>                          </span><a name="local-6989586621679187748"><a href="#local-6989586621679187748"><span class="hs-identifier">unparsed</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679187749"><a href="#local-6989586621679187749"><span class="hs-identifier">extra</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187750"><a href="#local-6989586621679187750"><span class="hs-identifier">other</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>              </span><a name="local-6989586621679187751"><a href="#local-6989586621679187751"><span class="hs-identifier">unparsed_args</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-64"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679187751"><span class="hs-identifier hs-var">unparsed_args</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-65"></a><span>            </span><span class="hs-special">(</span><span class="hs-string">&quot;-E&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679187752"><a href="#local-6989586621679187752"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><a href="#local-6989586621679187743"><span class="hs-identifier hs-var">parsed</span></a><span> </span><a href="#local-6989586621679187752"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679187753"><a href="#local-6989586621679187753"><span class="hs-identifier">flag</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187754"><a href="#local-6989586621679187754"><span class="hs-identifier">flagArg</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187755"><a href="#local-6989586621679187755"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679187753"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;-MF&quot;</span><span>
</span><a name="line-68"></a><span>                                </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679187753"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;-MT&quot;</span><span>
</span><a name="line-69"></a><span>                                </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679187753"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;-MQ&quot;</span><span>
</span><a name="line-70"></a><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679187744"><span class="hs-identifier hs-var">cpp_args</span></a><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679187749"><span class="hs-identifier hs-var">extra</span></a><span class="hs-special">,</span><a href="#local-6989586621679187750"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-special">`</span><a href="Language.C.Data.RList.html#snoc"><span class="hs-identifier hs-var">snoc</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187753"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-special">`</span><a href="Language.C.Data.RList.html#snoc"><span class="hs-identifier hs-var">snoc</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187754"><span class="hs-identifier hs-var">flagArg</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187755"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679187756"><a href="#local-6989586621679187756"><span class="hs-identifier">flag</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187757"><a href="#local-6989586621679187757"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span>  </span><a href="#local-6989586621679187756"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;-c&quot;</span><span>
</span><a name="line-73"></a><span>                        </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679187756"><span class="hs-identifier hs-var">flag</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-string">&quot;-S&quot;</span><span>
</span><a name="line-74"></a><span>                        </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-string">&quot;-M&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187756"><span class="hs-identifier hs-var">flag</span></a><span>
</span><a name="line-75"></a><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679187744"><span class="hs-identifier hs-var">cpp_args</span></a><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679187749"><span class="hs-identifier hs-var">extra</span></a><span class="hs-special">,</span><a href="#local-6989586621679187750"><span class="hs-identifier hs-var">other</span></a><span> </span><span class="hs-special">`</span><a href="Language.C.Data.RList.html#snoc"><span class="hs-identifier hs-var">snoc</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187756"><span class="hs-identifier hs-var">flag</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187757"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span>            </span><span class="hs-special">(</span><span class="hs-string">&quot;-o&quot;</span><span class="hs-glyph">:</span><a name="local-6989586621679187758"><a href="#local-6989586621679187758"><span class="hs-identifier">file</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187759"><a href="#local-6989586621679187759"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">out</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;two output files given&quot;</span><span>
</span><a name="line-78"></a><span>                               </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679187745"><span class="hs-identifier hs-var">inp</span></a><span class="hs-special">,</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679187758"><span class="hs-identifier hs-var">file</span></a><span class="hs-special">,</span><a href="#local-6989586621679187747"><span class="hs-identifier hs-var">cpp_opts</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679187748"><span class="hs-identifier hs-var">unparsed</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187759"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679187760"><a href="#local-6989586621679187760"><span class="hs-identifier">cpp_opt</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187761"><a href="#local-6989586621679187761"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679187762"><a href="#local-6989586621679187762"><span class="hs-identifier">opt</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187763"><a href="#local-6989586621679187763"><span class="hs-identifier">rest'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679187741"><span class="hs-identifier hs-var">getArgOpt</span></a><span> </span><a href="#local-6989586621679187760"><span class="hs-identifier hs-var">cpp_opt</span></a><span> </span><a href="#local-6989586621679187761"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-81"></a><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679187745"><span class="hs-identifier hs-var">inp</span></a><span class="hs-special">,</span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">,</span><a href="#local-6989586621679187747"><span class="hs-identifier hs-var">cpp_opts</span></a><span> </span><span class="hs-special">`</span><a href="Language.C.Data.RList.html#snoc"><span class="hs-identifier hs-var">snoc</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187762"><span class="hs-identifier hs-var">opt</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679187748"><span class="hs-identifier hs-var">unparsed</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187763"><span class="hs-identifier hs-var">rest'</span></a><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679187764"><a href="#local-6989586621679187764"><span class="hs-identifier">cfile</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187765"><a href="#local-6989586621679187765"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">`</span><span class="hs-identifier hs-var">isSuffixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187764"><span class="hs-identifier hs-var">cfile</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">words</span><span> </span><span class="hs-string">&quot;.c .hc .h&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">isJust</span><span> </span><a href="#local-6989586621679187745"><span class="hs-identifier hs-var">inp</span></a><span>
</span><a name="line-85"></a><span>                                   </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;two input files given&quot;</span><span>
</span><a name="line-86"></a><span>                                   </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679187764"><span class="hs-identifier hs-var">cfile</span></a><span class="hs-special">,</span><a href="#local-6989586621679187746"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">,</span><a href="#local-6989586621679187747"><span class="hs-identifier hs-var">cpp_opts</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679187748"><span class="hs-identifier hs-var">unparsed</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187765"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>            </span><span class="hs-special">(</span><a name="local-6989586621679187766"><a href="#local-6989586621679187766"><span class="hs-identifier">unknown</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187767"><a href="#local-6989586621679187767"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679187740"><span class="hs-identifier hs-var">mungeArgs</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679187744"><span class="hs-identifier hs-var">cpp_args</span></a><span class="hs-special">,</span><span class="hs-special">(</span><a href="#local-6989586621679187749"><span class="hs-identifier hs-var">extra</span></a><span> </span><span class="hs-special">`</span><a href="Language.C.Data.RList.html#snoc"><span class="hs-identifier hs-var">snoc</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187766"><span class="hs-identifier hs-var">unknown</span></a><span class="hs-special">,</span><a href="#local-6989586621679187750"><span class="hs-identifier hs-var">other</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187767"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679187743"><span class="hs-identifier hs-var">parsed</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span>    </span><a name="local-6989586621679187741"><a href="#local-6989586621679187741"><span class="hs-identifier">getArgOpt</span></a></a><span> </span><a name="local-6989586621679187768"><a href="#local-6989586621679187768"><span class="hs-identifier">cpp_opt</span></a></a><span> </span><a name="local-6989586621679187769"><a href="#local-6989586621679187769"><span class="hs-identifier">rest</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;-I&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187768"><span class="hs-identifier hs-var">cpp_opt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#IncludeDir"><span class="hs-identifier hs-var">IncludeDir</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679187768"><span class="hs-identifier hs-var">cpp_opt</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679187769"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;-U&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187768"><span class="hs-identifier hs-var">cpp_opt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#Undefine"><span class="hs-identifier hs-var">Undefine</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679187768"><span class="hs-identifier hs-var">cpp_opt</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679187769"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-string">&quot;-D&quot;</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679187768"><span class="hs-identifier hs-var">cpp_opt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679187742"><span class="hs-identifier hs-var">getDefine</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">2</span><span> </span><a href="#local-6989586621679187768"><span class="hs-identifier hs-var">cpp_opt</span></a><span class="hs-special">)</span><span class="hs-special">,</span><a href="#local-6989586621679187769"><span class="hs-identifier hs-var">rest</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-identifier">getArgOpt</span><span> </span><span class="hs-string">&quot;-include&quot;</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679187770"><a href="#local-6989586621679187770"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679187771"><a href="#local-6989586621679187771"><span class="hs-identifier">rest'</span></a></a><span class="hs-special">)</span><span>                     </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#IncludeFile"><span class="hs-identifier hs-var">IncludeFile</span></a><span> </span><a href="#local-6989586621679187770"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679187771"><span class="hs-identifier hs-var">rest'</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>    </span><span class="hs-identifier">getArgOpt</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-97"></a><span>    </span><a name="local-6989586621679187742"><a href="#local-6989586621679187742"><span class="hs-identifier">getDefine</span></a></a><span> </span><a name="local-6989586621679187772"><a href="#local-6989586621679187772"><span class="hs-identifier">opt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679187773"><a href="#local-6989586621679187773"><span class="hs-identifier">key</span></a></a><span class="hs-special">,</span><a name="local-6989586621679187774"><a href="#local-6989586621679187774"><span class="hs-identifier">val</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-char">'='</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679187772"><span class="hs-identifier hs-var">opt</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="Language.C.System.Preprocess.html#Define"><span class="hs-identifier hs-var">Define</span></a><span> </span><a href="#local-6989586621679187773"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679187774"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">tail</span><span> </span><a href="#local-6989586621679187774"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>
</span><a name="line-99"></a><span class="hs-keyword">type</span><span> </span><a name="ParseArgsState"><a href="Language.C.System.GCC.html#ParseArgsState"><span class="hs-identifier">ParseArgsState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span class="hs-special">,</span><span> </span><a href="Language.C.Data.RList.html#RList"><span class="hs-identifier hs-type">RList</span></a><span> </span><a href="Language.C.System.Preprocess.html#CppOption"><span class="hs-identifier hs-type">CppOption</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.RList.html#RList"><span class="hs-identifier hs-type">RList</span></a><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><a href="Language.C.Data.RList.html#RList"><span class="hs-identifier hs-type">RList</span></a><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-identifier">buildCppArgs</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.System.Preprocess.html#CppArgs"><span class="hs-identifier hs-type">CppArgs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-103"></a><a name="buildCppArgs"><a href="Language.C.System.GCC.html#buildCppArgs"><span class="hs-identifier">buildCppArgs</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#CppArgs"><span class="hs-identifier hs-var">CppArgs</span></a><span> </span><a name="local-6989586621679187781"><a href="#local-6989586621679187781"><span class="hs-identifier">options</span></a></a><span> </span><a name="local-6989586621679187782"><a href="#local-6989586621679187782"><span class="hs-identifier">extra_args</span></a></a><span> </span><a name="local-6989586621679187783"><a href="#local-6989586621679187783"><span class="hs-identifier">_tmpdir</span></a></a><span> </span><a name="local-6989586621679187784"><a href="#local-6989586621679187784"><span class="hs-identifier">input_file</span></a></a><span> </span><a name="local-6989586621679187785"><a href="#local-6989586621679187785"><span class="hs-identifier">output_file_opt</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-104"></a><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">concatMap</span><span> </span><a href="#local-6989586621679187786"><span class="hs-identifier hs-var">tOption</span></a><span> </span><a href="#local-6989586621679187781"><span class="hs-identifier hs-var">options</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679187787"><span class="hs-identifier hs-var">outputFileOpt</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;-E&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679187784"><span class="hs-identifier hs-var">input_file</span></a><span class="hs-special">]</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679187782"><span class="hs-identifier hs-var">extra_args</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>    </span><a name="local-6989586621679187786"><a href="#local-6989586621679187786"><span class="hs-identifier">tOption</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#IncludeDir"><span class="hs-identifier hs-var">IncludeDir</span></a><span> </span><a name="local-6989586621679187788"><a href="#local-6989586621679187788"><span class="hs-identifier">incl</span></a></a><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;-I&quot;</span><span class="hs-special">,</span><a href="#local-6989586621679187788"><span class="hs-identifier hs-var">incl</span></a><span class="hs-special">]</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-identifier">tOption</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#Define"><span class="hs-identifier hs-var">Define</span></a><span> </span><a name="local-6989586621679187789"><a href="#local-6989586621679187789"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679187790"><a href="#local-6989586621679187790"><span class="hs-identifier">value</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;-D&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679187789"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679187790"><span class="hs-identifier hs-var">value</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-string">&quot;=&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679187790"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier">tOption</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#Undefine"><span class="hs-identifier hs-var">Undefine</span></a><span> </span><a name="local-6989586621679187791"><a href="#local-6989586621679187791"><span class="hs-identifier">key</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;-U&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679187791"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier">tOption</span><span> </span><span class="hs-special">(</span><a href="Language.C.System.Preprocess.html#IncludeFile"><span class="hs-identifier hs-var">IncludeFile</span></a><span> </span><a name="local-6989586621679187792"><a href="#local-6989586621679187792"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;-include&quot;</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679187792"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-113"></a><span>    </span><a name="local-6989586621679187787"><a href="#local-6989586621679187787"><span class="hs-identifier">outputFileOpt</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;-o&quot;</span><span class="hs-special">,</span><a href="#local-6989586621679187793"><span class="hs-identifier hs-var">output_file</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679187793"><a href="#local-6989586621679187793"><span class="hs-identifier">output_file</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybeToList</span><span> </span><a href="#local-6989586621679187785"><span class="hs-identifier hs-var">output_file_opt</span></a><span> </span><span class="hs-special">]</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a></pre></body></html>