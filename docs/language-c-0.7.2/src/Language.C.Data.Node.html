<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- Module      :  Language.C.Syntax.Attributes</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- Copyright   :  (c) [1995..1999] Manuel M. T. Chakravarty</span><span>
</span><a name="line-6"></a><span class="hs-comment">--                (c) 2008 Benedikt Huber (stripped radically)</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- License     :  BSD-style</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- Maintainer  :  benedikt.huber@gmail.com</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Portability :  ghc</span><span>
</span><a name="line-11"></a><span class="hs-comment">--</span><span>
</span><a name="line-12"></a><span class="hs-comment">-- source position and unqiue name</span><span>
</span><a name="line-13"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-14"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.C.Data.Node</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-15"></a><span>   </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#undefNode"><span class="hs-identifier hs-var">undefNode</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#isUndefNode"><span class="hs-identifier hs-var">isUndefNode</span></a><span class="hs-special">,</span><span>
</span><a name="line-16"></a><span>   </span><a href="Language.C.Data.Node.html#mkNodeInfoOnlyPos"><span class="hs-identifier hs-var">mkNodeInfoOnlyPos</span></a><span class="hs-special">,</span><a href="Language.C.Data.Node.html#mkNodeInfoPosLen"><span class="hs-identifier hs-var">mkNodeInfoPosLen</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#mkNodeInfo"><span class="hs-identifier hs-var">mkNodeInfo</span></a><span class="hs-special">,</span><a href="Language.C.Data.Node.html#mkNodeInfo%27"><span class="hs-identifier hs-var">mkNodeInfo'</span></a><span class="hs-special">,</span><span>
</span><a name="line-17"></a><span>   </span><a href="Language.C.Data.Node.html#internalNode"><span class="hs-identifier hs-var">internalNode</span></a><span class="hs-special">,</span><span> </span><span class="hs-comment">-- deprecated, use undefNode</span><span>
</span><a name="line-18"></a><span>   </span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span class="hs-special">(</span><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier hs-var">nodeInfo</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#fileOfNode"><span class="hs-identifier hs-var">fileOfNode</span></a><span class="hs-special">,</span><span>
</span><a name="line-19"></a><span>   </span><a href="Language.C.Data.Node.html#posOfNode"><span class="hs-identifier hs-var">posOfNode</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#nameOfNode"><span class="hs-identifier hs-var">nameOfNode</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#getLastTokenPos"><span class="hs-identifier hs-var">getLastTokenPos</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#lengthOfNode"><span class="hs-identifier hs-var">lengthOfNode</span></a><span class="hs-special">,</span><span>
</span><a name="line-20"></a><span>   </span><a href="Language.C.Data.Node.html#eqByName"><span class="hs-identifier hs-var">eqByName</span></a><span class="hs-special">,</span><span>
</span><a name="line-21"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><a href="Language.C.Data.Position.html"><span class="hs-identifier">Language.C.Data.Position</span></a><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><a href="Language.C.Data.Name.html"><span class="hs-identifier">Language.C.Data.Name</span></a><span>     </span><span class="hs-special">(</span><a href="Language.C.Data.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Generics</span><span>
</span><a name="line-25"></a><span>
</span><a name="line-26"></a><span class="hs-comment">-- | Parsed entity attribute</span><span>
</span><a name="line-27"></a><span class="hs-keyword">data</span><span> </span><a name="NodeInfo"><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier">NodeInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="OnlyPos"><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier">OnlyPos</span></a></a><span>  </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="Language.C.Data.Position.html#PosLength"><span class="hs-identifier hs-type">PosLength</span></a><span>        </span><span class="hs-comment">-- only pos and last token (for internal stuff only)</span><span>
</span><a name="line-28"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a name="NodeInfo"><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier">NodeInfo</span></a></a><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><a href="Language.C.Data.Position.html#PosLength"><span class="hs-identifier hs-type">PosLength</span></a><span> </span><span class="hs-glyph">!</span><a href="Language.C.Data.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>  </span><span class="hs-comment">-- pos, last token and unique name</span><span>
</span><a name="line-29"></a><span>           </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Data</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Eq</span><span class="hs-special">,</span><span class="hs-identifier hs-type">Ord</span><span class="hs-special">)</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-32"></a><span>    </span><a name="local-8214565720323789998"><span class="hs-identifier">showsPrec</span></a><span> </span><a name="local-6989586621679043266"><a href="#local-6989586621679043266"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a name="local-6989586621679043267"><a href="#local-6989586621679043267"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679043268"><a href="#local-6989586621679043268"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-33"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;(OnlyPos &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679043266"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043267"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679043266"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043268"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-identifier">showsPrec</span><span> </span><a name="local-6989586621679043269"><a href="#local-6989586621679043269"><span class="hs-identifier">d</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><a name="local-6989586621679043270"><a href="#local-6989586621679043270"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679043271"><a href="#local-6989586621679043271"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679043272"><a href="#local-6989586621679043272"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-35"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;(NodeInfo &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679043269"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043270"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679043269"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043271"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot; &quot;</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showsPrec</span><span> </span><a href="#local-6989586621679043269"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679043272"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">showString</span><span> </span><span class="hs-string">&quot;)&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span class="hs-comment">-- name equality of attributes, used to define (name) equality of objects</span><span>
</span><a name="line-38"></a><span class="hs-comment">--instance Eq NodeInfo where</span><span>
</span><a name="line-39"></a><span class="hs-comment">--  (NodeInfo   _ _ id1) == (NodeInfo   _ _ id2) = id1 == id2</span><span>
</span><a name="line-40"></a><span class="hs-comment">--  _               == _               =</span><span>
</span><a name="line-41"></a><span class="hs-comment">--    error &quot;Attributes: Attempt to compare `OnlyPos' attributes!&quot;</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-comment">-- attribute ordering</span><span>
</span><a name="line-44"></a><span class="hs-comment">--instance Ord NodeInfo where</span><span>
</span><a name="line-45"></a><span class="hs-comment">--  (NodeInfo   _ _ id1) &lt;= (NodeInfo   _ _ id2) = id1 &lt;= id2</span><span>
</span><a name="line-46"></a><span class="hs-comment">--  _               &lt;= _               =</span><span>
</span><a name="line-47"></a><span class="hs-comment">--    error &quot;Attributes: Attempt to compare `OnlyPos' attributes!&quot;</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.Data.Position.html#Pos"><span class="hs-identifier hs-type">Pos</span></a><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-50"></a><span>  </span><a name="local-8214565720323816476"><a href="Language.C.Data.Position.html#posOf"><span class="hs-identifier">posOf</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a name="local-6989586621679043264"><a href="#local-6989586621679043264"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679043264"><span class="hs-identifier hs-var">pos</span></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-identifier">posOf</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><a name="local-6989586621679043265"><a href="#local-6989586621679043265"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679043265"><span class="hs-identifier hs-var">pos</span></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-comment">-- | get the number of characters an AST node spans</span><span>
</span><a name="line-54"></a><span class="hs-identifier">lengthOfNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-55"></a><a name="lengthOfNode"><a href="Language.C.Data.Node.html#lengthOfNode"><span class="hs-identifier">lengthOfNode</span></a></a><span> </span><a name="local-6989586621679043275"><a href="#local-6989586621679043275"><span class="hs-identifier">ni</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679043276"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-57"></a><span>    </span><a name="local-6989586621679043276"><a href="#local-6989586621679043276"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679043275"><span class="hs-identifier hs-var">ni</span></a><span> </span><span class="hs-keyword">of</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><a name="local-6989586621679043278"><a href="#local-6989586621679043278"><span class="hs-identifier">firstPos</span></a></a><span> </span><a name="local-6989586621679043279"><a href="#local-6989586621679043279"><span class="hs-identifier">lastTok</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679043277"><span class="hs-identifier hs-var">computeLength</span></a><span> </span><a href="#local-6989586621679043278"><span class="hs-identifier hs-var">firstPos</span></a><span> </span><a href="#local-6989586621679043279"><span class="hs-identifier hs-var">lastTok</span></a><span>
</span><a name="line-58"></a><span>                     </span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a name="local-6989586621679043280"><a href="#local-6989586621679043280"><span class="hs-identifier">firstPos</span></a></a><span> </span><a name="local-6989586621679043281"><a href="#local-6989586621679043281"><span class="hs-identifier">lastTok</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679043277"><span class="hs-identifier hs-var">computeLength</span></a><span> </span><a href="#local-6989586621679043280"><span class="hs-identifier hs-var">firstPos</span></a><span> </span><a href="#local-6989586621679043281"><span class="hs-identifier hs-var">lastTok</span></a><span>
</span><a name="line-59"></a><span>    </span><a name="local-6989586621679043277"><a href="#local-6989586621679043277"><span class="hs-identifier">computeLength</span></a></a><span> </span><a name="local-6989586621679043282"><a href="#local-6989586621679043282"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679043283"><a href="#local-6989586621679043283"><span class="hs-identifier">lastPos</span></a></a><span class="hs-special">,</span><a name="local-6989586621679043284"><a href="#local-6989586621679043284"><span class="hs-identifier">lastTokLen</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679043284"><span class="hs-identifier hs-var">lastTokLen</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-60"></a><span>                                           </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">posOffset</span><span> </span><a href="#local-6989586621679043283"><span class="hs-identifier hs-var">lastPos</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679043284"><span class="hs-identifier hs-var">lastTokLen</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-identifier">posOffset</span><span> </span><a href="#local-6989586621679043282"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">-- | get the position and length of the last token</span><span>
</span><a name="line-63"></a><span class="hs-identifier">getLastTokenPos</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Position.html#PosLength"><span class="hs-identifier hs-type">PosLength</span></a><span>
</span><a name="line-64"></a><a name="getLastTokenPos"><a href="Language.C.Data.Node.html#getLastTokenPos"><span class="hs-identifier">getLastTokenPos</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679043285"><a href="#local-6989586621679043285"><span class="hs-identifier">lastTok</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679043285"><span class="hs-identifier hs-var">lastTok</span></a><span>
</span><a name="line-65"></a><span class="hs-identifier">getLastTokenPos</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679043286"><a href="#local-6989586621679043286"><span class="hs-identifier">lastTok</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679043286"><span class="hs-identifier hs-var">lastTok</span></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">-- | a class for convenient access to the attributes of an attributed object</span><span>
</span><a name="line-68"></a><span class="hs-keyword">class</span><span> </span><a name="CNode"><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier">CNode</span></a></a><span> </span><a name="local-6989586621679043122"><a href="#local-6989586621679043122"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>  </span><a name="nodeInfo"><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier">nodeInfo</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679043122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-70"></a><span class="hs-keyword">instance</span><span> </span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>  </span><a name="local-8214565720323818016"><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier">nodeInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-72"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span> </span><a href="#local-6989586621679043123"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span> </span><a href="#local-6989586621679043124"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><a href="#local-6989586621679043123"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679043124"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-73"></a><span>  </span><a name="local-8214565720323818016"><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier">nodeInfo</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">either</span><span> </span><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier hs-var">nodeInfo</span></a><span> </span><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier hs-var">nodeInfo</span></a><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-identifier">nameOfNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="Language.C.Data.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span>
</span><a name="line-76"></a><a name="nameOfNode"><a href="Language.C.Data.Node.html#nameOfNode"><span class="hs-identifier">nameOfNode</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-77"></a><span class="hs-identifier">nameOfNode</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679043287"><a href="#local-6989586621679043287"><span class="hs-identifier">name</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679043287"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-78"></a><span class="hs-identifier">posOfNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span>
</span><a name="line-79"></a><a name="posOfNode"><a href="Language.C.Data.Node.html#posOfNode"><span class="hs-identifier">posOfNode</span></a></a><span> </span><a name="local-6989586621679043288"><a href="#local-6989586621679043288"><span class="hs-identifier">ni</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679043288"><span class="hs-identifier hs-var">ni</span></a><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a name="local-6989586621679043289"><a href="#local-6989586621679043289"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679043289"><span class="hs-identifier hs-var">pos</span></a><span class="hs-special">;</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><a name="local-6989586621679043290"><a href="#local-6989586621679043290"><span class="hs-identifier">pos</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679043290"><span class="hs-identifier hs-var">pos</span></a><span>
</span><a name="line-80"></a><span class="hs-identifier">fileOfNode</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span> </span><a href="#local-6989586621679043274"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679043274"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span>
</span><a name="line-81"></a><a name="fileOfNode"><a href="Language.C.Data.Node.html#fileOfNode"><span class="hs-identifier">fileOfNode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="Language.C.Data.Position.html#posFile"><span class="hs-identifier hs-var">posFile</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679043291"><span class="hs-identifier hs-var">justIf</span></a><span> </span><a href="Language.C.Data.Position.html#isSourcePos"><span class="hs-identifier hs-var">isSourcePos</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Node.html#posOfNode"><span class="hs-identifier hs-var">posOfNode</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier hs-var">nodeInfo</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-82"></a><span>    </span><a name="local-6989586621679043291"><a href="#local-6989586621679043291"><span class="hs-identifier">justIf</span></a></a><span> </span><a name="local-6989586621679043292"><a href="#local-6989586621679043292"><span class="hs-identifier">predicate</span></a></a><span> </span><a name="local-6989586621679043293"><a href="#local-6989586621679043293"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679043292"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679043293"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679043293"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-83"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-comment">-- | equality by name</span><span>
</span><a name="line-86"></a><span class="hs-identifier">eqByName</span><span>           </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#CNode"><span class="hs-identifier hs-type">CNode</span></a><span> </span><a href="#local-6989586621679043273"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679043273"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679043273"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-87"></a><a name="eqByName"><a href="Language.C.Data.Node.html#eqByName"><span class="hs-identifier">eqByName</span></a></a><span> </span><a name="local-6989586621679043294"><a href="#local-6989586621679043294"><span class="hs-identifier">obj1</span></a></a><span> </span><a name="local-6989586621679043295"><a href="#local-6989586621679043295"><span class="hs-identifier">obj2</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier hs-var">nodeInfo</span></a><span> </span><a href="#local-6989586621679043294"><span class="hs-identifier hs-var">obj1</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#nodeInfo"><span class="hs-identifier hs-var">nodeInfo</span></a><span> </span><a href="#local-6989586621679043295"><span class="hs-identifier hs-var">obj2</span></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">-- attribute identifier creation</span><span>
</span><a name="line-91"></a><span class="hs-comment">-- -----------------------------</span><span>
</span><a name="line-92"></a><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">internalNode</span><span> </span><span class="hs-pragma">&quot;use undefNode instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><a name="line-93"></a><span class="hs-identifier">internalNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-94"></a><a name="internalNode"><a href="Language.C.Data.Node.html#internalNode"><span class="hs-identifier">internalNode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Node.html#undefNode"><span class="hs-identifier hs-var">undefNode</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | create a node with neither name nor positional information</span><span>
</span><a name="line-97"></a><span class="hs-identifier">undefNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-98"></a><a name="undefNode"><a href="Language.C.Data.Node.html#undefNode"><span class="hs-identifier">undefNode</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a href="Language.C.Data.Position.html#nopos"><span class="hs-identifier hs-var">nopos</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Position.html#nopos"><span class="hs-identifier hs-var">nopos</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><span class="hs-comment">-- | return True if the node carries neither name nor positional information</span><span>
</span><a name="line-101"></a><span class="hs-identifier">isUndefNode</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-102"></a><a name="isUndefNode"><a href="Language.C.Data.Node.html#isUndefNode"><span class="hs-identifier">isUndefNode</span></a></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a name="local-6989586621679043296"><a href="#local-6989586621679043296"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="Language.C.Data.Position.html#isNoPos"><span class="hs-identifier hs-var">isNoPos</span></a><span> </span><a href="#local-6989586621679043296"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-103"></a><span>                          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-104"></a><span class="hs-identifier">isUndefNode</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-105"></a><span>
</span><a name="line-106"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- | Given only a source position, create a new node attribute</span><span>
</span><a name="line-108"></a><span class="hs-identifier">mkNodeInfoOnlyPos</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-109"></a><a name="mkNodeInfoOnlyPos"><a href="Language.C.Data.Node.html#mkNodeInfoOnlyPos"><span class="hs-identifier">mkNodeInfoOnlyPos</span></a></a><span> </span><a name="local-6989586621679043297"><a href="#local-6989586621679043297"><span class="hs-identifier">pos</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span> </span><a href="#local-6989586621679043297"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Position.html#nopos"><span class="hs-identifier hs-var">nopos</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- | Given a source position and the position and length of the last token, create a new node attribute</span><span>
</span><a name="line-112"></a><span class="hs-identifier">mkNodeInfoPosLen</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Position.html#PosLength"><span class="hs-identifier hs-type">PosLength</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-113"></a><a name="mkNodeInfoPosLen"><a href="Language.C.Data.Node.html#mkNodeInfoPosLen"><span class="hs-identifier">mkNodeInfoPosLen</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Node.html#OnlyPos"><span class="hs-identifier hs-var">OnlyPos</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- | Given a source position and a unique name, create a new attribute</span><span>
</span><a name="line-116"></a><span class="hs-comment">-- identifier</span><span>
</span><a name="line-117"></a><span class="hs-identifier">mkNodeInfo</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-118"></a><a name="mkNodeInfo"><a href="Language.C.Data.Node.html#mkNodeInfo"><span class="hs-identifier">mkNodeInfo</span></a></a><span> </span><a name="local-6989586621679043298"><a href="#local-6989586621679043298"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679043299"><a href="#local-6989586621679043299"><span class="hs-identifier">name</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><a href="#local-6989586621679043298"><span class="hs-identifier hs-var">pos</span></a><span> </span><span class="hs-special">(</span><a href="Language.C.Data.Position.html#nopos"><span class="hs-identifier hs-var">nopos</span></a><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679043299"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span class="hs-comment">-- | Given a source position, the position and length of the last token and a unique name, create a new attribute</span><span>
</span><a name="line-121"></a><span class="hs-comment">-- identifier. Strict in</span><span>
</span><a name="line-122"></a><span class="hs-identifier">mkNodeInfo'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Language.C.Data.Position.html#Position"><span class="hs-identifier hs-type">Position</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Position.html#PosLength"><span class="hs-identifier hs-type">PosLength</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-type">NodeInfo</span></a><span>
</span><a name="line-123"></a><a name="mkNodeInfo%27"><a href="Language.C.Data.Node.html#mkNodeInfo%27"><span class="hs-identifier">mkNodeInfo'</span></a></a><span> </span><a name="local-6989586621679043300"><a href="#local-6989586621679043300"><span class="hs-identifier">pos</span></a></a><span> </span><a name="local-6989586621679043301"><a href="#local-6989586621679043301"><span class="hs-identifier">lasttok</span></a></a><span> </span><a name="local-6989586621679043302"><a href="#local-6989586621679043302"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Language.C.Data.Node.html#NodeInfo"><span class="hs-identifier hs-var">NodeInfo</span></a><span> </span><a href="#local-6989586621679043300"><span class="hs-identifier hs-var">pos</span></a><span> </span><a href="#local-6989586621679043301"><span class="hs-identifier hs-var">lasttok</span></a><span> </span><a href="#local-6989586621679043302"><span class="hs-identifier hs-var">name</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a></pre></body></html>